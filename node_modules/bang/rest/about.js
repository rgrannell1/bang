
"use strict"




var fs             = require('fs')
var mustache       = require('mustache')

var constants      = require('bang/commons/constants')
var httpStatus     = require('bang/commons/http-status')
var enginePatterns = require('bang/data/engines.json')
var logger         = require('bang/logging/logger')
var Engine         = require('bang/model/engine')





var about = (config, req, res) => {

	var view = {
		engines: enginePatterns.map(Engine).map(engine => {

			return {
				patterns: engine.patterns,
				baseURL:  engine.baseUrl
			}

		}),
		version: constants.version
	}

	fs.readFile(constants.paths.HELP_PATH, (err, template) => {

		if (err) {

			logger.fatal('could not load help file.')

			process.exit(1)

		}

		res
		.set('Content-Type', 'text/html')
		.status(httpStatus.ok)
		.send(mustache.render(template.toString( ), view))
		.end( )

	})

}





module.exports = about
