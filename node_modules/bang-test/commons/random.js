
"use strict"




var constants = require('bang-test/commons/constants')





var random = {
	bangURL: { }
}





random.fromSet = (upperLength, charset) => {

	var out = [ ]
	var len = Math.floor(Math.random( ) * upperLength)

	for (var ith = 0; ith < len; ++ith) {
		out[ith] = charset[Math.floor(Math.random( ) * charset.length)]
	}

	return out.join('')

}





// -- todo refactor this untidy code into multiple functions.

random.bangURL.search = (port, upperLength, whitespaceLength, pattern) => {

	return 'http://localhost:' + port + '/search?q=' + random.fromSet(upperLength, constants.charset.base64)

}




random.bangURL.searchWithPattern = (port, upperLength, whitespaceLength, pattern) => {

	var base = 'http://localhost:' + port + '/search?q='

	var query         = random.fromSet(upperLength, constants.charset.base64)
	var paddedPattern =
		(random.whitespace(whitespaceLength) || ' ') +
		pattern                                      +
		(random.whitespace(whitespaceLength) || ' ')

	var index = Math.floor(Math.random( ) * query.length)

	return base + query.substr(0, index) + paddedPattern + query.substr(index)

}




random.whitespace = upperLength => {
	return random.fromSet(upperLength, constants.charset.whitespace)
}





module.exports = random
